// ==EMEVD==
// @docs    er-common.emedf.json
// @compress    DCX_KRAK
// @game    Sekiro
// @string    "N:\\GR\\data\\Param\\event\\common_func.emevd\u0000N:\\GR\\data\\Param\\event\\common_macro.emevd\u0000\u0000\u0000\u0000\u0000\u0000"
// @linked    [0,82]
// @version    3.4.2
// ==/EMEVD==

$Event(0, Default, function() {
    RegisterBonfire(73010, 30101950, 0, 0, 0, 5);
    InitializeCommonEvent(0, 90005646, 30100800, 30102840, 30102841, 30101840, 30102840, 2590);
    InitializeCommonEvent(0, 90005501, 30100510, 30101510, 1, 30101510, 30101511, 30101512, 30100511);
    InitializeCommonEvent(0, 90005501, 30100515, 30101515, 3, 30101515, 30101516, 30101517, 30100516);
    InitializeCommonEvent(0, 90005501, 30100510, 30100511, 1, 30101510, 30101511, 30101512, 30100512);
    InitializeCommonEvent(0, 90005501, 30100515, 30100516, 3, 30101515, 30101516, 30101517, 30100517);
    InitializeEvent(0, 30102510, 0);
    InitializeCommonEvent(0, 90005680, 30100500, 30100501, 30100502, 30100503, 30101500);
    InitializeEvent(0, 30102500, 0);
    InitializeEvent(0, 30102560, 0);
    InitializeEvent(0, 30102580, 0);
    InitializeEvent(0, 30102200, 0);
    InitializeEvent(0, 30100100, 30100540, 30101540, 30103540, 27041);
    InitializeCommonEvent(0, 90005620, 30100570, 30101570, 30101571, 0, 30102570, 30102571, 30102572);
    InitializeCommonEvent(0, 90005621, 30100570, 30101573);
    InitializeCommonEvent(0, 90005200, 30100202, 30003, 20003, 30102202, 1056964608, 0, 0, 0, 0);
    InitializeCommonEvent(1, 90005200, 30100203, 30003, 20003, 30102202, 0, 0, 0, 0, 0);
    InitializeCommonEvent(0, 90005200, 30100200, 30003, 20003, 30102200, 0, 0, 0, 0, 0);
    InitializeCommonEvent(1, 90005200, 30100201, 30003, 20003, 30102200, 1065353216, 0, 0, 0, 0);
    InitializeCommonEvent(0, 90005250, 30100205, 30102205, 0, 0);
    InitializeCommonEvent(1, 90005250, 30100206, 30102205, 1056964608, 0);
    InitializeCommonEvent(0, 90005250, 30100215, 30102215, 0, 0);
    InitializeCommonEvent(0, 90005200, 30100211, 30003, 20003, 30102211, 0, 0, 0, 0, 0);
    InitializeCommonEvent(0, 90005211, 30100212, 30003, 20003, 30102212, 1084227584, 0, 0, 0, 0, 0);
    InitializeCommonEvent(0, 90005250, 30100213, 30102213, 0, 3011);
    InitializeCommonEvent(0, 90005200, 30100228, 30003, 20003, 30102228, 0, 0, 0, 0, 0);
    InitializeCommonEvent(0, 90005200, 30100236, 30003, 20003, 30102236, 0, 0, 0, 0, 0);
    InitializeCommonEvent(1, 90005200, 30100237, 30003, 20003, 30102236, 1045220557, 0, 0, 0, 0);
    InitializeCommonEvent(2, 90005200, 30100238, 30003, 20003, 30102236, 1056964608, 0, 0, 0, 0);
    InitializeCommonEvent(3, 90005200, 30100239, 30003, 20003, 30102236, 1077936128, 0, 0, 0, 0);
    InitializeCommonEvent(0, 90005250, 30100240, 30102240, 0, 3008);
    InitializeCommonEvent(1, 90005200, 30100241, 30003, 20003, 30102240, 1056964608, 0, 0, 0, 0);
    InitializeCommonEvent(0, 90005250, 30100232, 30102232, 0, 0);
    InitializeCommonEvent(1, 90005250, 30100233, 30102232, 0, 0);
    InitializeCommonEvent(2, 90005250, 30100234, 30102232, 0, 0);
    InitializeCommonEvent(0, 90005250, 30100250, 30102250, 0, 3001);
    InitializeCommonEvent(1, 90005250, 30100251, 30102250, 0, 3001);
    InitializeCommonEvent(0, 90005200, 30100255, 30001, 20001, 30102255, 0, 0, 0, 0, 0);
    InitializeCommonEvent(1, 90005200, 30100256, 30001, 20001, 30102255, 1045220557, 0, 0, 0, 0);
    InitializeCommonEvent(2, 90005200, 30100257, 30001, 20001, 30102255, 1056964608, 0, 0, 0, 0);
    InitializeCommonEvent(3, 90005200, 30100258, 30001, 20001, 30102258, 0, 0, 0, 0, 0);
    InitializeCommonEvent(0, 90005261, 30100209, 30102209, 1065353216, 0, 3001);
    InitializeCommonEvent(0, 90005261, 30100219, 30102219, 1092616192, 1056964608, 0);
    InitializeCommonEvent(1, 90005261, 30100220, 30102219, 1092616192, 1065353216, 0);
    InitializeCommonEvent(2, 90005261, 30100221, 30102219, 1092616192, 1082130432, 0);
    InitializeCommonEvent(0, 90005261, 30100222, 30102221, 1084227584, 0, 0);
    InitializeCommonEvent(0, 90005201, 30100226, 30000, 20000, 1092616192, 0, 0, 0, 0, 0);
    InitializeCommonEvent(0, 90005250, 30100300, 30102300, 0, 0);
    InitializeEvent(0, 30102480, 0);
    InitializeEvent(0, 30102490, 0);
    InitializeEvent(0, 30102400, 30100400);
    InitializeEvent(4, 30102410, 30100400, 30102454, 30103451, 30102455, 30103452);
    InitializeCommonEvent(0, 90005250, 30100410, 30102415, 0, 0);
    InitializeEvent(1, 30102400, 30100410);
    InitializeEvent(1, 30102410, 30100410, 30102410, 30103410, 30102411, 30103411);
    InitializeEvent(2, 30102410, 30100410, 30102413, 30103411, 30102412, 30103412);
    InitializeEvent(0, 30102465, 30100410);
    InitializeCommonEvent(0, 90005250, 30100420, 30102425, 0, 0);
    InitializeEvent(2, 30102400, 30100420);
    InitializeEvent(3, 30102410, 30100420, 30102420, 30103420, 30102412, 30103421);
    InitializeEvent(1, 30102465, 30100420);
    InitializeEvent(0, 30102445, 0);
    InitializeEvent(1, 30102450, 0);
    InitializeEvent(2, 30102455, 0);
    InitializeEvent(3, 30102460, 0);
    InitializeEvent(0, 30102470, 0);
    InitializeEvent(0, 30102800, 0);
    InitializeEvent(0, 30102810, 0);
    InitializeEvent(0, 30102849, 0);
    InitializeEvent(0, 30102811, 0);
});

$Event(50, Default, function() {
    InitializeEvent(0, 30100050, 0);
    InitializeEvent(0, 30100519, 0);
});

$Event(30100050, Default, function() {
    EndIf(ThisEventSlot());
});

$Event(30100100, Default, function(X0_4, X4_4, X8_4, X12_4) {
    if (EventFlag(X0_4)) {
        ReproduceAssetAnimation(X4_4, 2);
        DisableObjAct(X4_4, X12_4);
        EndEvent();
    }
L0:
    WaitFor(PlayerIsInOwnWorld() && ObjActEventFlag(X8_4));
    SetNetworkconnectedEventFlagID(X0_4, ON);
    ForceAnimationPlayback(X4_4, 1, false, false, false);
    EndEvent();
});

$Event(30102200, Restart, function() {
    DeleteAssetfollowingSFX(30101300, false);
    DeleteAssetfollowingSFX(30101301, false);
    DeleteAssetfollowingSFX(30101500, false);
    CreateAssetfollowingSFX(30101300, 201, 806721);
    CreateAssetfollowingSFX(30101301, 201, 806721);
    CreateAssetfollowingSFX(30101500, 108, 806721);
    EndEvent();
});

$Event(30102400, Restart, function(X0_4) {
    if (!EventFlag(30102465)) {
        EnableCharacterInvincibility(X0_4);
        DisableLockOnPoint(X0_4, 220);
        DisableCharacterHPBarDisplay(X0_4);
        SetSpEffect(X0_4, 5000);
        SetNetworkUpdateRate(X0_4, true, CharacterUpdateFrequency.AlwaysUpdate);
        if (PlayerIsInOwnWorld()) {
            SetNetworkUpdateAuthority(X0_4, AuthorityLevel.Forced);
        }
        EndEvent();
    }
L0:
    EndEvent();
});

$Event(30102300, Restart, function(X0_4, X4_4) {
    EndIf(EventFlag(30100465));
    area = EntityInRadiusOfEntity(X0_4, 10000, 2.4, 1) || EntityInRadiusOfEntity(X0_4, X4_4, 2.4, 1);
    EndIf(EventFlag(30100465));
    WaitFor(area);
    EndIf(EventFlag(30100465));
    CreateDamagingAsset(X0_4, X0_4, 100, 103000, DamageTargetType.Character, 2.3, 1, 0);
    WaitFixedTimeFrames(1);
    DeleteAssetEvent(X0_4);
    WaitFixedTimeSeconds(0.7);
    RestartEvent();
});

$Event(30102305, Restart, function(X0_4, X4_4) {
    EndIf(EventFlag(30100465));
    area = EntityInRadiusOfEntity(X0_4, 10000, 3.1, 1) || EntityInRadiusOfEntity(X0_4, X4_4, 3.1, 1);
    EndIf(EventFlag(30100465));
    WaitFor(area);
    EndIf(EventFlag(30100465));
    CreateDamagingAsset(X0_4, X0_4, 100, 103000, DamageTargetType.Character, 3.1, 1, 0);
    WaitFixedTimeFrames(1);
    DeleteAssetEvent(X0_4);
    WaitFixedTimeSeconds(0.7);
    RestartEvent();
});

$Event(30102410, Restart, function(X0_4, X4_4, X8_4, X12_4, X16_4) {
    EndIf(!PlayerIsInOwnWorld());
    WaitFor(InArea(X0_4, X4_4));
    if (!InArea(10000, X12_4)) {
        ChangeCharacterPatrolBehavior(X0_4, X8_4);
    } else {
L1:
        ChangeCharacterPatrolBehavior(X0_4, X16_4);
        Goto(L20);
    }
L20:
    WaitFor(!InArea(X0_4, X4_4));
    RestartEvent();
});

$Event(30102445, Restart, function() {
    EndIf(!PlayerIsInOwnWorld());
    WaitFor(
        InArea(10000, 30102405)
            && !EventFlag(30102445)
            && ((CharacterType(10000, TargetType.BlackPhantom) && CharacterHasSpEffect(10000, 3710))
                || CharacterType(10000, TargetType.Alive)
                || CharacterType(10000, TargetType.GrayPhantom)
                || CharacterType(10000, TargetType.WhitePhantom)));
    EndIf(EventFlag(30102460));
    DisableCharacterAI(30100400);
    SetEventFlagID(30102445, ON);
    SetEventFlagID(30102450, OFF);
    SetEventFlagID(30102455, OFF);
    ForceAnimationPlayback(30100400, 20001, true, true, true);
    WarpCharacterAndSetFloor(30100400, TargetEntityType.Area, 30102460, -1, 30100400);
    ForceAnimationPlayback(30100400, 20000, true, true, true);
    ChangeCharacterPatrolBehavior(30100400, 30103400);
    WaitFixedTimeSeconds(1.5);
    EnableCharacterAI(30100400);
L0:
    RestartEvent();
});

$Event(30102450, Restart, function() {
    EndIf(!PlayerIsInOwnWorld());
    WaitFor(
        InArea(10000, 30102451)
            && !EventFlag(30102450)
            && ((CharacterType(10000, TargetType.BlackPhantom) && CharacterHasSpEffect(10000, 3710))
                || CharacterType(10000, TargetType.Alive)
                || CharacterType(10000, TargetType.GrayPhantom)
                || CharacterType(10000, TargetType.WhitePhantom)));
    EndIf(EventFlag(30102460));
    DisableCharacterAI(30100400);
    SetEventFlagID(30102445, OFF);
    SetEventFlagID(30102450, ON);
    SetEventFlagID(30102455, OFF);
    RequestCharacterAnimationReset(30100400, Disabled);
    ForceAnimationPlayback(30100400, 20001, true, true, false);
    WarpCharacterAndSetFloor(30100400, TargetEntityType.Area, 30102461, -1, 30100400);
    ForceAnimationPlayback(30100400, 20000, true, true, false);
    ChangeCharacterPatrolBehavior(30100400, 30103450);
    WaitFixedTimeSeconds(1.5);
    EnableCharacterAI(30100400);
    RestartEvent();
});

$Event(30102455, Restart, function() {
    EndIf(!PlayerIsInOwnWorld());
    WaitFor(
        InArea(10000, 30102452)
            && !EventFlag(30102455)
            && !EventFlag(30100550)
            && ((CharacterType(10000, TargetType.BlackPhantom) && CharacterHasSpEffect(10000, 3710))
                || CharacterType(10000, TargetType.Alive)
                || CharacterType(10000, TargetType.GrayPhantom)
                || CharacterType(10000, TargetType.WhitePhantom)));
    EndIf(EventFlag(30102460));
    WaitFor(!EventFlag(30100503) && !EventFlag(30100500));
    DisableCharacterAI(30100400);
    SetEventFlagID(30102445, OFF);
    SetEventFlagID(30102455, ON);
    SetEventFlagID(30102450, OFF);
    RequestCharacterAnimationReset(30100400, Disabled);
    ForceAnimationPlayback(30100400, 20001, true, true, false);
    WarpCharacterAndSetFloor(30100400, TargetEntityType.Area, 30102462, -1, 30100400);
    ForceAnimationPlayback(30100400, 20000, true, true, false);
    ChangeCharacterPatrolBehavior(30100400, 30103451);
    WaitFixedTimeSeconds(1.5);
    EnableCharacterAI(30100400);
L0:
    RestartEvent();
L2:
    RestartEvent();
});

$Event(30102460, Restart, function() {
    EndIf(!PlayerIsInOwnWorld());
    EndIf(EventFlag(30102460));
    WaitFor(EventFlag(30100500) && !EventFlag(30100503));
    if (EventFlag(30100500)) {
        WaitFor(
            InArea(10000, 30102453)
                && ((CharacterType(10000, TargetType.BlackPhantom) && CharacterHasSpEffect(10000, 3710))
                    || CharacterType(10000, TargetType.Alive)
                    || CharacterType(10000, TargetType.GrayPhantom)
                    || CharacterType(10000, TargetType.WhitePhantom)));
        if (EventFlag(30100500)) {
            DisableCharacterAI(30100400);
            RequestCharacterAnimationReset(30100400, Disabled);
            ForceAnimationPlayback(30100400, 20001, true, true, false);
            WarpCharacterAndSetFloor(30100400, TargetEntityType.Area, 30102463, -1, 30100400);
            ForceAnimationPlayback(30100400, 20000, true, true, false);
            SetEventFlagID(30102445, OFF);
            SetEventFlagID(30102450, ON);
            SetEventFlagID(30102455, ON);
            SetEventFlagID(30102460, ON);
        }
    }
L0:
    RestartEvent();
});

$Event(30102465, Restart, function(X0_4) {
    WaitFor(EventFlag(30102460) && InArea(X0_4, 30102470));
    ForceCharacterDeath(X0_4, false);
    ForceCharacterDeath(30100400, false);
    WaitFor(InArea(30100400, 30102470) && InArea(30100410, 30102470) && InArea(30100420, 30102470));
    SetEventFlagID(30100465, ON);
    EndEvent();
});

$Event(30102470, Restart, function() {
    EndIf(EventFlag(30102460));
    WaitFor(EventFlag(30102445) && !CharacterBackreadStatus(30100400));
    SetEventFlagID(30102445, OFF);
    RestartEvent();
});

$Event(30102480, Restart, function() {
    EndIf(!EventFlag(30100465));
    DisableCharacter(30100400);
    DisableCharacter(30100410);
    DisableCharacter(30100420);
    EndEvent();
});

$Event(30102490, Restart, function() {
    EndIf(!PlayerIsInOwnWorld());
    EndIf(EventFlag(30107100));
    WaitFor(EventFlag(30100465));
    EndIf(!PlayerIsInOwnWorld());
    AwardItemLot(30100100);
    EndEvent();
});

$Event(30102510, Default, function() {
    InitializeCommonEvent(0, 90005500, 30100510, 30100511, 1, 30101510, 30101511, 30103511, 30101512, 30103512, 30102511, 30102512, 30100512, 30100513, 0);
    InitializeCommonEvent(0, 90005500, 30100515, 30100516, 3, 30101515, 30101516, 30103516, 30101517, 30103517, 30102516, 30102517, 30100517, 30100518, 0);
});

$Event(30100519, Default, function() {
    EndIf(ThisEventSlot());
    SetEventFlagID(30100510, ON);
});

$Event(30102500, Default, function() {
    InitializeCommonEvent(0, 90005681, 30100500, 30100501, 30100502, 30100503, 30101500);
    InitializeEvent(0, 30102521, 30100503, 30102500, 30100500);
});

$Event(30102520, Default, function(X0_4, X4_4, X8_4, X12_4, X16_4, X20_4, X24_4, X28_4, X32_4, X36_4, X40_4, X44_4, X48_4, X52_4) {
    flagArea &= !EventFlag(X0_4);
    if (X8_4 != 0) {
        flagArea &= InArea(10000, X8_4);
    }
    WaitFor(flagArea);
    CreateBulletOwner(X12_4);
    if (Signed(X24_4) != 0) {
        if (Signed(X16_4) != 0) {
            ShootBullet(X12_4, X4_4, X24_4, X16_4, 0, 0, 0);
        } else {
            ShootBullet(X12_4, X4_4, X24_4, 101100, 0, 0, 0);
        }
        if (Signed(X20_4) != 0) {
            ShootBullet(X12_4, X4_4, X24_4, X20_4, 0, 0, 0);
        } else {
            ShootBullet(X12_4, X4_4, X24_4, 101102, 0, 0, 0);
        }
    }
L1:
    if (Signed(X28_4) != 0) {
        if (Signed(X16_4) != 0) {
            ShootBullet(X12_4, X4_4, X28_4, X16_4, 0, 0, 0);
        } else {
            ShootBullet(X12_4, X4_4, X28_4, 101100, 0, 0, 0);
        }
        if (Signed(X20_4) != 0) {
            ShootBullet(X12_4, X4_4, X28_4, X20_4, 0, 0, 0);
        } else {
            ShootBullet(X12_4, X4_4, X28_4, 101102, 0, 0, 0);
        }
    }
L2:
    if (Signed(X32_4) != 0) {
        if (Signed(X16_4) != 0) {
            ShootBullet(X12_4, X4_4, X32_4, X16_4, 0, 0, 0);
        } else {
            ShootBullet(X12_4, X4_4, X32_4, 101100, 0, 0, 0);
        }
        if (Signed(X20_4) != 0) {
            ShootBullet(X12_4, X4_4, X32_4, X20_4, 0, 0, 0);
        } else {
            ShootBullet(X12_4, X4_4, X32_4, 101102, 0, 0, 0);
        }
    }
L3:
    if (Signed(X36_4) != 0) {
        if (Signed(X16_4) != 0) {
            ShootBullet(X12_4, X4_4, X36_4, X16_4, 0, 0, 0);
        } else {
            ShootBullet(X12_4, X4_4, X36_4, 101100, 0, 0, 0);
        }
        if (Signed(X20_4) != 0) {
            ShootBullet(X12_4, X4_4, X36_4, X20_4, 0, 0, 0);
        } else {
            ShootBullet(X12_4, X4_4, X36_4, 101102, 0, 0, 0);
        }
    }
L4:
    if (Signed(X40_4) != 0) {
        if (Signed(X16_4) != 0) {
            ShootBullet(X12_4, X4_4, X40_4, X16_4, 0, 0, 0);
        } else {
            ShootBullet(X12_4, X4_4, X40_4, 101100, 0, 0, 0);
        }
        if (Signed(X20_4) != 0) {
            ShootBullet(X12_4, X4_4, X40_4, X20_4, 0, 0, 0);
        } else {
            ShootBullet(X12_4, X4_4, X40_4, 101102, 0, 0, 0);
        }
    }
L5:
    if (Signed(X44_4) != 0) {
        if (Signed(X16_4) != 0) {
            ShootBullet(X12_4, X4_4, X44_4, X16_4, 0, 0, 0);
        } else {
            ShootBullet(X12_4, X4_4, X44_4, 101100, 0, 0, 0);
        }
        if (Signed(X20_4) != 0) {
            ShootBullet(X12_4, X4_4, X44_4, X20_4, 0, 0, 0);
        } else {
            ShootBullet(X12_4, X4_4, X44_4, 101102, 0, 0, 0);
        }
    }
L6:
    if (Signed(X48_4) != 0) {
        if (Signed(X16_4) != 0) {
            ShootBullet(X12_4, X4_4, X48_4, X16_4, 0, 0, 0);
        } else {
            ShootBullet(X12_4, X4_4, X48_4, 101100, 0, 0, 0);
        }
        if (Signed(X20_4) != 0) {
            ShootBullet(X12_4, X4_4, X48_4, X20_4, 0, 0, 0);
        } else {
            ShootBullet(X12_4, X4_4, X48_4, 101102, 0, 0, 0);
        }
    }
L7:
    if (Signed(X52_4) != 0) {
        if (Signed(X16_4) != 0) {
            ShootBullet(X12_4, X4_4, X52_4, X16_4, 0, 0, 0);
        } else {
            ShootBullet(X12_4, X4_4, X52_4, 101100, 0, 0, 0);
        }
        if (Signed(X20_4) != 0) {
            ShootBullet(X12_4, X4_4, X52_4, X20_4, 0, 0, 0);
        } else {
            ShootBullet(X12_4, X4_4, X52_4, 101102, 0, 0, 0);
        }
    }
L8:
    WaitFixedTimeSeconds(7.2);
    RestartEvent();
});

$Event(30102521, Default, function(X0_4, X4_4, X8_4) {
    flagArea &= !EventFlag(X0_4);
    if (X4_4 != 0) {
        flagArea &= InArea(10000, X4_4);
    }
    WaitFor(flagArea);
    CreateBulletOwner(X8_4);
    if (EventFlag(50)) {
        ShootBullet(30100500, 30101500, 102, 801103300, 0, 0, 0);
        ShootBullet(30100500, 30101500, 102, 801103305, 0, 0, 0);
        ShootBullet(30100500, 30101500, 104, 801103300, 0, 0, 0);
        ShootBullet(30100500, 30101500, 104, 801103305, 0, 0, 0);
        ShootBullet(30100500, 30101500, 109, 801103300, 0, 0, 0);
        ShootBullet(30100500, 30101500, 109, 801103305, 0, 0, 0);
    }
    if (EventFlag(51)) {
        ShootBullet(30100500, 30101500, 102, 801103310, 0, 0, 0);
        ShootBullet(30100500, 30101500, 102, 801103305, 0, 0, 0);
        ShootBullet(30100500, 30101500, 104, 801103310, 0, 0, 0);
        ShootBullet(30100500, 30101500, 104, 801103305, 0, 0, 0);
        ShootBullet(30100500, 30101500, 109, 801103310, 0, 0, 0);
        ShootBullet(30100500, 30101500, 109, 801103305, 0, 0, 0);
    }
    if (EventFlag(52)) {
        ShootBullet(30100500, 30101500, 102, 801103320, 0, 0, 0);
        ShootBullet(30100500, 30101500, 102, 801103305, 0, 0, 0);
        ShootBullet(30100500, 30101500, 104, 801103320, 0, 0, 0);
        ShootBullet(30100500, 30101500, 104, 801103305, 0, 0, 0);
        ShootBullet(30100500, 30101500, 109, 801103320, 0, 0, 0);
        ShootBullet(30100500, 30101500, 109, 801103305, 0, 0, 0);
    }
    if (EventFlag(53)) {
        ShootBullet(30100500, 30101500, 102, 801103330, 0, 0, 0);
        ShootBullet(30100500, 30101500, 102, 801103305, 0, 0, 0);
        ShootBullet(30100500, 30101500, 104, 801103330, 0, 0, 0);
        ShootBullet(30100500, 30101500, 104, 801103305, 0, 0, 0);
        ShootBullet(30100500, 30101500, 109, 801103330, 0, 0, 0);
        ShootBullet(30100500, 30101500, 109, 801103305, 0, 0, 0);
    }
    if (EventFlag(54)) {
        ShootBullet(30100500, 30101500, 102, 801103340, 0, 0, 0);
        ShootBullet(30100500, 30101500, 102, 801103305, 0, 0, 0);
        ShootBullet(30100500, 30101500, 104, 801103340, 0, 0, 0);
        ShootBullet(30100500, 30101500, 104, 801103305, 0, 0, 0);
        ShootBullet(30100500, 30101500, 109, 801103340, 0, 0, 0);
        ShootBullet(30100500, 30101500, 109, 801103305, 0, 0, 0);
    }
    if (EventFlag(55)) {
        ShootBullet(30100500, 30101500, 102, 801103350, 0, 0, 0);
        ShootBullet(30100500, 30101500, 102, 801103305, 0, 0, 0);
        ShootBullet(30100500, 30101500, 104, 801103350, 0, 0, 0);
        ShootBullet(30100500, 30101500, 104, 801103305, 0, 0, 0);
        ShootBullet(30100500, 30101500, 109, 801103350, 0, 0, 0);
        ShootBullet(30100500, 30101500, 109, 801103305, 0, 0, 0);
    }
    if (EventFlag(56)) {
        ShootBullet(30100500, 30101500, 102, 801103360, 0, 0, 0);
        ShootBullet(30100500, 30101500, 102, 801103305, 0, 0, 0);
        ShootBullet(30100500, 30101500, 104, 801103360, 0, 0, 0);
        ShootBullet(30100500, 30101500, 104, 801103305, 0, 0, 0);
        ShootBullet(30100500, 30101500, 109, 801103360, 0, 0, 0);
        ShootBullet(30100500, 30101500, 109, 801103305, 0, 0, 0);
    }
    if (EventFlag(57)) {
        ShootBullet(30100500, 30101500, 102, 801103370, 0, 0, 0);
        ShootBullet(30100500, 30101500, 102, 801103305, 0, 0, 0);
        ShootBullet(30100500, 30101500, 104, 801103370, 0, 0, 0);
        ShootBullet(30100500, 30101500, 104, 801103305, 0, 0, 0);
        ShootBullet(30100500, 30101500, 109, 801103370, 0, 0, 0);
        ShootBullet(30100500, 30101500, 109, 801103305, 0, 0, 0);
    }
    WaitFixedTimeSeconds(7.2);
    RestartEvent();
});

$Event(30102530, Default, function(X0_4, X4_4, X8_4, X12_4, X16_4, X20_4, X24_4, X28_4, X32_4, X36_4, X40_4, X44_4, X48_4, X52_4) {
    flagArea &= !EventFlag(X0_4);
    if (X8_4 != 0) {
        flagArea &= InArea(10000, X8_4);
    }
    WaitFor(flagArea);
    CreateBulletOwner(X12_4);
    if (Signed(X24_4) != 0) {
        if (Signed(X16_4) != 0) {
            ShootBullet(X12_4, X4_4, X24_4, X16_4, 0, 0, 0);
        } else {
            ShootBullet(X12_4, X4_4, X24_4, 101100, 0, 0, 0);
        }
        if (Signed(X20_4) != 0) {
            ShootBullet(X12_4, X4_4, X24_4, X20_4, 0, 0, 0);
        } else {
            ShootBullet(X12_4, X4_4, X24_4, 101102, 0, 0, 0);
        }
    }
L1:
    if (Signed(X28_4) != 0) {
        if (Signed(X16_4) != 0) {
            ShootBullet(X12_4, X4_4, X28_4, X16_4, 0, 0, 0);
        } else {
            ShootBullet(X12_4, X4_4, X28_4, 101100, 0, 0, 0);
        }
        if (Signed(X20_4) != 0) {
            ShootBullet(X12_4, X4_4, X28_4, X20_4, 0, 0, 0);
        } else {
            ShootBullet(X12_4, X4_4, X28_4, 101102, 0, 0, 0);
        }
    }
L2:
    if (Signed(X32_4) != 0) {
        if (Signed(X16_4) != 0) {
            ShootBullet(X12_4, X4_4, X32_4, X16_4, 0, 0, 0);
        } else {
            ShootBullet(X12_4, X4_4, X32_4, 101100, 0, 0, 0);
        }
        if (Signed(X20_4) != 0) {
            ShootBullet(X12_4, X4_4, X32_4, X20_4, 0, 0, 0);
        } else {
            ShootBullet(X12_4, X4_4, X32_4, 101102, 0, 0, 0);
        }
    }
L3:
    if (Signed(X36_4) != 0) {
        if (Signed(X16_4) != 0) {
            ShootBullet(X12_4, X4_4, X36_4, X16_4, 0, 0, 0);
        } else {
            ShootBullet(X12_4, X4_4, X36_4, 101100, 0, 0, 0);
        }
        if (Signed(X20_4) != 0) {
            ShootBullet(X12_4, X4_4, X36_4, X20_4, 0, 0, 0);
        } else {
            ShootBullet(X12_4, X4_4, X36_4, 101102, 0, 0, 0);
        }
    }
L4:
    if (Signed(X36_4) != 0) {
        if (Signed(X16_4) != 0) {
            ShootBullet(X12_4, X4_4, X40_4, X16_4, 0, 0, 0);
        } else {
            ShootBullet(X12_4, X4_4, X40_4, 101100, 0, 0, 0);
        }
        if (Signed(X20_4) != 0) {
            ShootBullet(X12_4, X4_4, X40_4, X20_4, 0, 0, 0);
        } else {
            ShootBullet(X12_4, X4_4, X40_4, 101102, 0, 0, 0);
        }
    }
L5:
    if (Signed(X36_4) != 0) {
        if (Signed(X16_4) != 0) {
            ShootBullet(X12_4, X4_4, X44_4, X16_4, 0, 0, 0);
        } else {
            ShootBullet(X12_4, X4_4, X44_4, 101100, 0, 0, 0);
        }
        if (Signed(X20_4) != 0) {
            ShootBullet(X12_4, X4_4, X44_4, X20_4, 0, 0, 0);
        } else {
            ShootBullet(X12_4, X4_4, X44_4, 101102, 0, 0, 0);
        }
    }
L6:
    if (Signed(X36_4) != 0) {
        if (Signed(X16_4) != 0) {
            ShootBullet(X12_4, X4_4, X48_4, X16_4, 0, 0, 0);
        } else {
            ShootBullet(X12_4, X4_4, X48_4, 101100, 0, 0, 0);
        }
        if (Signed(X20_4) != 0) {
            ShootBullet(X12_4, X4_4, X48_4, X20_4, 0, 0, 0);
        } else {
            ShootBullet(X12_4, X4_4, X48_4, 101102, 0, 0, 0);
        }
    }
L7:
    if (Signed(X36_4) != 0) {
        if (Signed(X16_4) != 0) {
            ShootBullet(X12_4, X4_4, X52_4, X16_4, 0, 0, 0);
        } else {
            ShootBullet(X12_4, X4_4, X52_4, 101100, 0, 0, 0);
        }
        if (Signed(X20_4) != 0) {
            ShootBullet(X12_4, X4_4, X52_4, X20_4, 0, 0, 0);
        } else {
            ShootBullet(X12_4, X4_4, X52_4, 101102, 0, 0, 0);
        }
    }
L8:
    WaitFixedTimeSeconds(7.2);
    RestartEvent();
});

$Event(30102540, Default, function(X0_4, X4_4, X8_4, X12_4, X16_4) {
    if (!(((EventFlag(X0_4) && EventFlag(X4_4)) || (!EventFlag(X0_4) && !EventFlag(X4_4)))
        && EventFlag(X12_4))) {
        if (EventFlag(X0_4)) {
            WaitFor(
                !EventFlag(X0_4)
                    || (EventFlag(X4_4) && HasDamageType(X16_4, 20000, DamageType.Unspecified)));
            if (MapHasPermissionToUpdate(false, 0, 0, 0, 0)) {
                SetNetworkconnectedEventFlagID(X0_4, OFF);
                SetNetworkconnectedEventFlagID(X12_4, ON);
            }
            SetEventFlagID(X4_4, OFF);
            SetEventFlagID(X8_4, ON);
            ForceAnimationPlayback(X16_4, 21, false, true, false);
            if (MapHasPermissionToUpdate(false, 0, 0, 0, 0)) {
                SetNetworkconnectedEventFlagID(X12_4, OFF);
            }
            RestartEvent();
        }
L0:
        WaitFor(
            EventFlag(X0_4)
                || (!EventFlag(X4_4) && HasDamageType(X16_4, 20000, DamageType.Unspecified)));
        if (MapHasPermissionToUpdate(false, 0, 0, 0, 0)) {
            SetNetworkconnectedEventFlagID(X0_4, ON);
            SetNetworkconnectedEventFlagID(X12_4, ON);
        }
        SetEventFlagID(X4_4, ON);
        ForceAnimationPlayback(X16_4, 12, false, true, false);
        if (MapHasPermissionToUpdate(false, 0, 0, 0, 0)) {
            SetNetworkconnectedEventFlagID(X12_4, OFF);
        }
        SetEventFlagID(X8_4, OFF);
        RestartEvent();
    }
L9:
    WaitFor(!EventFlag(X12_4));
    RestartEvent();
});

$Event(301002550, Restart, function() {
    WaitFor(EventFlag(30100550) && !EventFlag(30100500));
    SetEventFlagID(30100550, OFF);
    RestartEvent();
});

$Event(30102560, Restart, function() {
    if (!EventFlag(30100500)) {
        DeleteMapSFX(30102463, true);
        WaitFixedTimeSeconds(5);
        SpawnMapSFX(30102462);
        RestartEvent();
    }
L0:
    DeleteMapSFX(30102462, true);
    WaitFixedTimeSeconds(5);
    SpawnMapSFX(30102463);
    RestartEvent();
});

$Event(30102580, Default, function() {
    RegisterLadder(30100580, 30100581, 30101580);
    RegisterLadder(30100582, 30100583, 30101582);
    RegisterLadder(30100584, 30100585, 30101584);
});

$Event(30102800, Restart, function() {
    EndIf(EventFlag(30100800));
    WaitFor(CharacterHPValue(30100800) <= 0 && CharacterHPValue(30100801) <= 0);
    WaitFixedTimeSeconds(4);
    PlaySE(30100800, SoundType.SFX, 888880000);
    WaitFor(CharacterDead(30100800) && CharacterDead(30100801));
    HandleBossDefeatAndDisplayBanner(30100800, TextBannerType.EnemyFelled);
    //boss rewards (3 bonus items + guaranteed flag)
    InitializeCommonEvent(0,90001033,1049304203,1049304124,1049304128,-1,1049304867,1049304868,1049304869,1049304870,1049305422,1049305425,1049305427,1049305430,1049300203);
    WaitFixedTimeSeconds(6);
    WarpPlayer(11, 10, 0, 0, 11102021, 0);
});

$Event(30102810, Restart, function() {
    if (EventFlag(30100800)) {
        DisableCharacter(30100800);
        DisableCharacterCollision(30100800);
        ForceCharacterDeath(30100800, false);
        DisableCharacter(30100801);
        DisableCharacterCollision(30100801);
        ForceCharacterDeath(30100801, false);
        EndEvent();
    }
L0:
    DisableCharacterAI(30100800);
    DisableCharacterAI(30100801);
    WaitFor(EventFlag(30102805) && InArea(10000, 30102800));
L2:
    EnableCharacterAI(30100800);
    SetNetworkUpdateRate(30100800, true, CharacterUpdateFrequency.AlwaysUpdate);
    DisplayBossHealthBar(Enabled, 30100800, 0, 902500300);
    EnableCharacterAI(30100801);
    SetNetworkUpdateRate(30100801, true, CharacterUpdateFrequency.AlwaysUpdate);
    DisplayBossHealthBar(Enabled, 30100801, 1, 902500301);
});

$Event(30102811, Restart, function() {
    EndIf(EventFlag(30100800));
    WaitFor(CharacterDead(30100800) || CharacterDead(30100801));
    SetEventFlagID(30102802, ON);
});

$Event(30102849, Restart, function() {
    InitializeCommonEvent(0, 9005800, 30100800, 30101800, 30102800, 30102805, 30105800, 10000, 0, 0);
    InitializeCommonEvent(0, 9005801, 30100800, 30101800, 30102800, 30102805, 30102806, 10000);
    InitializeCommonEvent(0, 9005811, 30100800, 30101800, 3, 0);
    InitializeCommonEvent(0, 9005822, 30100800, 920200, 30102805, 30102806, 0, 30102802, 0, 0);
});
