// ==EMEVD==
// @docs    er-common.emedf.json
// @compress    DCX_KRAK
// @game    Sekiro
// @string    "N:\\GR\\data\\Param\\event\\common_func.emevd\u0000N:\\GR\\data\\Param\\event\\common_macro.emevd\u0000\u0000\u0000\u0000\u0000\u0000"
// @linked    [0,82]
// @version    3.4.2
// ==/EMEVD==

$Event(0, Default, function() {
    //inf hp/fp/stam
    InitializeCommonEvent(0, 90001001, 0);
    RegisterBonfire(1043310000, 1043311950, 0, 0, 0, 5);
    InitializeCommonEvent(0, 90005100, 76161, 76158, 1043311980, 77110, 3, 78110, 78111, 78112, 78113, 78114, 78115, 78116, 78117, 78118, 78119);
    RegisterBonfire(1043310001, 1043311951, 0, 0, 0, 5);
    RegisterBonfire(1043310002, 1043311952, 0, 0, 0, 5);
    InitializeEvent(0, 1043312580, 0);
    InitializeCommonEvent(0, 900005610, 1043311650, 100, 800, 0);
    InitializeCommonEvent(0, 90005250, 1043310205, 1043312200, 0, -1);
    InitializeCommonEvent(0, 90005250, 1043310206, 1043312200, 0, -1);
    InitializeCommonEvent(0, 90005250, 1043310207, 1043312200, 0, -1);
    InitializeCommonEvent(0, 90005250, 1043310208, 1043312200, 0, -1);
    InitializeCommonEvent(0, 90005250, 1043310209, 1043312200, 0, -1);
    InitializeCommonEvent(0, 90005250, 1043310212, 1043312200, 0, -1);
    InitializeCommonEvent(0, 90005250, 1043310213, 1043312200, 0, -1);
    InitializeCommonEvent(0, 90005250, 1043310203, 1043312201, 0, -1);
    InitializeCommonEvent(0, 90005250, 1043310204, 1043312201, 0, -1);
    InitializeCommonEvent(0, 90005250, 1043310211, 1043312201, 0, -1);
    InitializeCommonEvent(0, 90005250, 1043310280, 1043312201, 0, -1);
    InitializeCommonEvent(0, 90005250, 1043310205, 1043312280, 0, -1);
    InitializeCommonEvent(0, 90005250, 1043310206, 1043312280, 0, -1);
    InitializeCommonEvent(0, 90005250, 1043310207, 1043312280, 0, -1);
    InitializeCommonEvent(0, 90005250, 1043310208, 1043312280, 0, -1);
    InitializeCommonEvent(0, 90005250, 1043310209, 1043312280, 0, -1);
    InitializeCommonEvent(0, 90005250, 1043310212, 1043312280, 0, -1);
    InitializeCommonEvent(0, 90005250, 1043310213, 1043312280, 0, -1);
    InitializeCommonEvent(0, 90005250, 1043310203, 1043312280, 0, -1);
    InitializeCommonEvent(0, 90005250, 1043310204, 1043312280, 0, -1);
    InitializeCommonEvent(0, 90005250, 1043310211, 1043312280, 0, -1);
    InitializeCommonEvent(0, 90005250, 1043310280, 1043312280, 0, -1);
    InitializeCommonEvent(0, 90005250, 1043310214, 1043312218, 0, -1);
    InitializeCommonEvent(0, 90005250, 1043310215, 1043312213, 0, -1);
    InitializeCommonEvent(0, 90005250, 1043310216, 1043312213, 0, -1);
    InitializeCommonEvent(0, 90005250, 1043310218, 1043312218, 0, -1);
    InitializeEvent(0, 1043312443, 1043310215, 1043312213);
    InitializeEvent(1, 1043312443, 1043310216, 1043312213);
    InitializeEvent(2, 1043312443, 1043310218, 1043312213);
    InitializeCommonEvent(0, 90005250, 1043310217, 1043312213, 1084227584, -1);
    InitializeCommonEvent(0, 90005250, 1043310220, 1043312220, 0, -1);
    InitializeCommonEvent(0, 90005250, 1043310221, 1043312220, 0, -1);
    InitializeCommonEvent(0, 90005250, 1043310222, 1043312220, 0, -1);
    InitializeCommonEvent(0, 90005250, 1043310223, 1043312223, 0, -1);
    InitializeCommonEvent(0, 90005250, 1043310224, 1043312223, 0, -1);
    InitializeCommonEvent(0, 90005250, 1043310225, 1043312223, 0, -1);
    InitializeCommonEvent(0, 90005250, 1043310226, 1043312223, 0, -1);
    InitializeCommonEvent(0, 90005250, 1043310227, 1043312223, 0, -1);
    InitializeCommonEvent(0, 90005250, 1043310228, 1043312223, 0, -1);
    InitializeCommonEvent(0, 90005271, 1043310245, 0, -1);
    InitializeCommonEvent(0, 90005271, 1043310246, 0, -1);
    InitializeCommonEvent(0, 90005271, 1043310267, 0, -1);
    InitializeCommonEvent(0, 90005271, 1043310268, 0, -1);
    InitializeCommonEvent(0, 90005250, 1043310281, 1043312250, 0, -1);
    InitializeEvent(3, 1043312443, 1043310281, 1043312250);
    InitializeCommonEvent(0, 90005271, 1043310252, 0, -1);
    InitializeCommonEvent(1, 90005271, 1043310271, 0, -1);
    InitializeCommonEvent(2, 90005271, 1043310272, 0, -1);
    InitializeCommonEvent(0, 90005251, 1043310255, 1084227584, 0, -1);
    InitializeCommonEvent(0, 90005250, 1043310256, 1043312256, 0, 3023);
    InitializeCommonEvent(0, 90005250, 1043310262, 1043312262, 1065353216, 3031);
    InitializeEvent(4, 1043312443, 1043310262, 1043312262);
    InitializeCommonEvent(0, 90005271, 1043310264, 0, -1);
    InitializeCommonEvent(0, 90005250, 1043310285, 1043312285, 0, -1);
    InitializeCommonEvent(0, 90005250, 1043310269, 1043312285, 0, -1);
    InitializeCommonEvent(0, 90005250, 1043310270, 1043312285, 0, -1);
    InitializeEvent(0, 1043312242, 1043315240, 1043312242);
    InitializeEvent(0, 1043312223, 1043315223, 1043312223);
    InitializeCommonEvent(0, 90005250, 1043310304, 1043312220, 0, -1);
    InitializeCommonEvent(0, 90005250, 1043310305, 1043312220, 0, -1);
    InitializeCommonEvent(0, 90005250, 1043310306, 1043312220, 0, -1);
    InitializeCommonEvent(0, 90005250, 1043310307, 1043312220, 0, -1);
    InitializeCommonEvent(0, 90005250, 1043310311, 1043312223, 0, -1);
    InitializeCommonEvent(0, 90005250, 1043310312, 1043312223, 0, -1);
    InitializeCommonEvent(0, 90005250, 1043310313, 1043312223, 0, -1);
    InitializeCommonEvent(0, 90005250, 1043310314, 1043312223, 0, -1);
    InitializeCommonEvent(0, 90005250, 1043310315, 1043312223, 0, -1);
    InitializeCommonEvent(0, 90005250, 1043310316, 1043312223, 0, -1);
    InitializeCommonEvent(0, 90005271, 1043310352, 0, -1);
    InitializeCommonEvent(0, 90005250, 1043310353, 1043312223, 0, -1);
    InitializeCommonEvent(0, 90005250, 1043310354, 1043312223, 0, -1);
    InitializeCommonEvent(0, 90005250, 1043310357, 1043312223, 0, -1);
    InitializeCommonEvent(0, 90005250, 1043310400, 1043312400, 0, -1);
    InitializeCommonEvent(0, 90005250, 1043310401, 1043312400, 0, -1);
    InitializeCommonEvent(0, 90005250, 1043310402, 1043312400, 0, -1);
    InitializeCommonEvent(0, 90005250, 1043310403, 1043312403, 0, -1);
    InitializeCommonEvent(0, 90005260, 1043310405, 1043312403, 1084227584, 0, -1);
    InitializeCommonEvent(0, 90005201, 1043310420, 30005, 20005, 1077936128, 0, 0, 0, 0, 0);
    InitializeCommonEvent(0, 90005200, 1043310430, 30000, 20000, 1043312430, 0, 0, 0, 0, 0);
    InitializeCommonEvent(0, 90005250, 1043310434, 1043312430, 0, -1);
    InitializeCommonEvent(0, 90005250, 1043310440, 1043312442, 0, -1);
    InitializeCommonEvent(0, 90005250, 1043310441, 1043312442, 0, -1);
    InitializeCommonEvent(0, 90005251, 1043310442, 1084227584, 0, -1);
    InitializeCommonEvent(0, 90005501, 1043310510, 1043310511, 3, 1043311510, 1043311511, 1043311512, 1043310512);
    InitializeEvent(0, 1043312510, 0);
    if (EventFlag(57)) {
        InitializeCommonEvent(0, 90005695, 1043311600, 1043311600, 200, 0, 802001270, 1065353216, 0, 1065353216);
    }
    if (EventFlag(56)) {
        InitializeCommonEvent(0, 90005695, 1043311600, 1043311600, 200, 0, 802001260, 1065353216, 0, 1065353216);
    }
    if (EventFlag(55)) {
        InitializeCommonEvent(0, 90005695, 1043311600, 1043311600, 200, 0, 802001250, 1065353216, 0, 1065353216);
    }
    if (EventFlag(54)) {
        InitializeCommonEvent(0, 90005695, 1043311600, 1043311600, 200, 0, 802001240, 1065353216, 0, 1065353216);
    }
    if (EventFlag(53)) {
        InitializeCommonEvent(0, 90005695, 1043311600, 1043311600, 200, 0, 802001230, 1065353216, 0, 1065353216);
    }
    if (EventFlag(52)) {
        InitializeCommonEvent(0, 90005695, 1043311600, 1043311600, 200, 0, 802001220, 1065353216, 0, 1065353216);
    }
    if (EventFlag(51)) {
        InitializeCommonEvent(0, 90005695, 1043311600, 1043311600, 200, 0, 802001210, 1065353216, 0, 1065353216);
    }
    if (EventFlag(50)) {
        InitializeCommonEvent(0, 90005695, 1043311600, 1043311600, 200, 0, 802001200, 1065353216, 0, 1065353216);
    }
    InitializeCommonEvent(0, 90005706, 1043310700, 930023, 0);
    InitializeCommonEvent(0, 90005704, 1043310705, 3401, 3400, 1043309201, 3);
    InitializeCommonEvent(0, 90005703, 1043310705, 3401, 3402, 1043309201, 3401, 3400, 3403, -1);
    InitializeCommonEvent(0, 90005702, 1043310705, 3403, 3400, 3403);
    InitializeEvent(0, 1043310705, 1043310705, 1043311700);
    InitializeCommonEvent(0, 90005750, 1043311701, 4110, 110620, 400061, 400061, 1043319208, 0);
    InitializeEvent(0, 1043310706, 0);
    InitializeEvent(0, 1043310707, 1043310705);
    InitializeEvent(0, 1043310708, 0);
    InitializeEvent(0, 1043312709, 1043310705, 1043311700);
});

$Event(50, Default, function() {
    SetCharacterBackreadState(1043310700, true);
    SetCharacterBackreadState(1043310705, true);
    InitializeEvent(0, 1043310519, 0);
});

$Event(1043312443, Restart, function(X0_4, X4_4) {
    onlineChrSpArea = PlayerIsInOwnWorld()
        && ((CharacterType(10000, TargetType.BlackPhantom) && CharacterHasSpEffect(10000, 3710))
            || CharacterType(10000, TargetType.Alive)
            || CharacterType(10000, TargetType.BluePhantom)
            || CharacterType(10000, TargetType.WhitePhantom))
        && InArea(10000, X4_4);
    SetSpEffect(X0_4, 8080);
    WaitFixedTimeSeconds(0.4);
    RestartEvent();
});

$Event(1043312242, Restart, function(X0_4, X4_4) {
    ClearSpEffect(X0_4, 4800);
    SetSpEffect(X0_4, 4802);
    EndIf(EventFlag(1043312240));
    SetSpEffect(X0_4, 4800);
    WaitFor(
        ((CharacterType(10000, TargetType.BlackPhantom) && CharacterHasSpEffect(10000, 3710))
            || CharacterType(10000, TargetType.Alive)
            || CharacterType(10000, TargetType.GrayPhantom)
            || CharacterType(10000, TargetType.WhitePhantom))
            && (HasDamageType(X0_4, 10000, DamageType.Unspecified)
                || HasDamageType(X0_4, 35000, DamageType.Unspecified)
                || HasDamageType(35000, X0_4, DamageType.Unspecified)
                || EntityInRadiusOfEntity(10000, X0_4, 10, 1)
                || EntityInRadiusOfEntity(35000, X0_4, 10, 1)
                || InArea(10000, X4_4)
                || InArea(35000, X4_4)));
    SetNetworkconnectedEventFlagID(1043312240, ON);
    ClearSpEffect(X0_4, 4800);
});

$Event(1043312223, Restart, function(X0_4, X4_4) {
    ClearSpEffect(X0_4, 4800);
    ClearSpEffect(X0_4, 5655);
    SetSpEffect(X0_4, 4802);
    EndIf(EventFlag(1043312223));
    SetSpEffect(X0_4, 4800);
    SetSpEffect(X0_4, 5655);
    WaitFor(
        ((CharacterType(10000, TargetType.BlackPhantom) && CharacterHasSpEffect(10000, 3710))
            || CharacterType(10000, TargetType.Alive)
            || CharacterType(10000, TargetType.GrayPhantom)
            || CharacterType(10000, TargetType.WhitePhantom))
            && (HasDamageType(X0_4, 10000, DamageType.Unspecified)
                || HasDamageType(X0_4, 35000, DamageType.Unspecified)
                || HasDamageType(35000, X0_4, DamageType.Unspecified)
                || EntityInRadiusOfEntity(10000, X0_4, 10, 1)
                || EntityInRadiusOfEntity(35000, X0_4, 10, 1)
                || InArea(10000, X4_4)
                || InArea(35000, X4_4)));
    SetNetworkconnectedEventFlagID(1043312223, ON);
    ClearSpEffect(X0_4, 4800);
    ClearSpEffect(X0_4, 5655);
});

$Event(1043312510, Default, function() {
    InitializeCommonEvent(0, 90005500, 1043310510, 1043310511, 3, 1043311510, 1043311511, 1043313511, 1043311512, 1043313512, 1043312511, 1043312512, 1043310512, 1043310513, 0);
});

$Event(1043310519, Default, function() {
    EndIf(ThisEventSlot());
    SetEventFlagID(1043310510, OFF);
});

$Event(1043312580, Default, function() {
    RegisterLadder(1043310580, 1043310851, 1043311580);
    RegisterLadder(1043310582, 1043310853, 1043311582);
    RegisterLadder(1043310584, 1043310855, 1043311584);
    RegisterLadder(1043310586, 1043310857, 1043311586);
    RegisterLadder(1043310588, 1043310859, 1043311588);
    RegisterLadder(1043310590, 1043310861, 1043311590);
    RegisterLadder(1043310592, 1043310863, 1043311592);
    EndEvent();
});

$Event(1043313700, Restart, function(X0_4) {
    SetCharacterBackreadState(X0_4, false);
    EnableCharacter(X0_4);
    ForceAnimationPlayback(X0_4, 30023, false, false, false);
    EndEvent();
});

$Event(1043310705, Restart, function(X0_4, X4_4) {
    DisableNetworkSync();
    WaitFixedTimeFrames(1);
    if (PlayerIsInOwnWorld()) {
        if (EventFlag(3400)) {
            SetEventFlagID(1043319202, OFF);
        }
    }
L10:
    GotoIf(L5, EventFlag(3405));
    GotoIf(L7, EventFlag(3407));
    DisableCharacter(X0_4);
    SetCharacterBackreadState(X0_4, true);
    WaitFor(EventFlag(3405) || EventFlag(3407));
    RestartEvent();
L5:
L7:
    GotoIf(L0, EventFlag(3400));
    GotoIf(L1, EventFlag(3401));
    GotoIf(L3, EventFlag(3403));
L0:
    EnableCharacter(X0_4);
    SetCharacterBackreadState(X0_4, false);
    ForceAnimationPlayback(X0_4, 90100, false, false, false);
    IssueShortWarpRequest(X0_4, TargetEntityType.Area, 1043312700, -1);
    RequestAssetRestoration(X4_4);
    EnableAssetInvunerability(X4_4);
    Goto(L20);
L1:
    EnableCharacter(X0_4);
    SetCharacterBackreadState(X0_4, false);
    SetCharacterTeamType(X0_4, TeamType.HostileNPC);
    Goto(L20);
L3:
    DisableCharacter(X0_4);
    SetCharacterBackreadState(X0_4, true);
    if (PlayerIsInOwnWorld()) {
        SetEventFlagID(1043319208, ON);
    }
    Goto(L20);
L20:
    WaitFor(!EventFlag(3405) && !EventFlag(3407));
    RestartEvent();
});

$Event(1043310706, Default, function() {
    EndIf(!PlayerIsInOwnWorld());
    EndIf(ThisEventSlot());
    WaitFor(EventFlag(3405) && (EventFlag(1043319206) || EventFlag(3403)));
    SetEventFlagID(3398, ON);
    EndIf(!(EventFlag(1043319206) && EventFlag(1043300800)));
    SetEventFlagID(3418, ON);
});

$Event(1043310707, Default, function(X0_4) {
    EndIf(!PlayerIsInOwnWorld());
    EndIf(AnyBatchEventFlags(3406, 3417));
    WaitFor(
        EventFlag(1043319206) && EventFlag(3405) && !EntityInRadiusOfEntity(10000, X0_4, 100, 1));
    SetEventFlagID(3418, ON);
});

$Event(1043310708, Default, function() {
    EndIf(!PlayerIsInOwnWorld());
    EndIf(EventFlag(1043300800));
    WaitFor(EventFlag(1043300800) && EventFlag(3406));
    SetEventFlagID(3418, ON);
});

$Event(1043312709, Restart, function(X0_4, X4_4) {
    if (!ThisEventSlot()) {
        WaitFor(
            !CharacterHasSpEffect(X0_4, 9624)
                && CharacterBackreadStatus(X0_4)
                && EventFlag(3401)
                && (EventFlag(3405) || EventFlag(3407))
                && PlayerIsInOwnWorld());
    }
L1:
    DisableAssetInvunerability(X4_4);
    RequestAssetDestruction(X4_4, 0);
});
